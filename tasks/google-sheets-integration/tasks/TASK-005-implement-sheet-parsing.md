# TASK-005: Реализация парсинга данных из Google Sheets

## Статус: ⏳ В ожидании

**Дата создания:** 2025-01-30  
**Приоритет:** Критический  
**Зависимости:** TASK-004

---

## Описание

Реализовать парсинг данных из Google Sheets. Первая строка содержит заголовки колонок. Нужно извлечь колонки "UUID" и "Person Brizy" и преобразовать их в структурированный формат.

## Что нужно сделать

### 1. Добавить метод парсинга в GoogleSheetsService

**Метод:** `parseSheetData($data)`

**Логика:**
1. Принять массив строк из Google Sheets API
2. Первая строка - заголовки колонок
3. Найти индексы колонок "UUID" и "Person Brizy"
4. Для каждой последующей строки извлечь значения этих колонок
5. Вернуть массив объектов с полями `uuid` и `person_brizy`

### 2. Обработка различных форматов

- Поддержка разных регистров названий колонок (UUID, uuid, Uuid)
- Поддержка пробелов в названиях ("Person Brizy", "PersonBrizy")
- Пропуск пустых строк
- Валидация UUID формата (опционально)

### 3. Обработка ошибок

- Если колонка "UUID" не найдена - выбросить исключение
- Если колонка "Person Brizy" не найдена - выбросить исключение или использовать null
- Логирование предупреждений о пустых значениях

---

## Ожидаемые результаты

### Проверка парсинга заголовков

- [ ] Метод корректно определяет первую строку как заголовки
- [ ] Метод находит колонку "UUID" независимо от регистра
- [ ] Метод находит колонку "Person Brizy" независимо от регистра и пробелов
- [ ] Если колонки не найдены, выбрасывается понятное исключение

### Проверка извлечения данных

- [ ] Для каждой строки (кроме первой) извлекаются значения UUID и Person Brizy
- [ ] Пустые строки пропускаются
- [ ] Результат возвращается в виде массива объектов/массивов:
  ```php
  [
    ['uuid' => 'uuid1', 'person_brizy' => 'Name1'],
    ['uuid' => 'uuid2', 'person_brizy' => 'Name2'],
  ]
  ```

### Проверка обработки граничных случаев

- [ ] Пустая таблица обрабатывается корректно (возвращает пустой массив)
- [ ] Таблица только с заголовками обрабатывается корректно
- [ ] Строки с пустыми UUID пропускаются или обрабатываются отдельно
- [ ] Строки с пустыми Person Brizy обрабатываются (используется null)

### Проверка валидации

- [ ] UUID валидируется (формат UUID v4, опционально)
- [ ] Person Brizy обрезается от лишних пробелов
- [ ] Все данные экранируются для безопасности

---

## Связанные файлы

- `dashboard/api/services/GoogleSheetsService.php` - добавление метода `parseSheetData()`

---

## Примечания

- Учесть, что Google Sheets API может возвращать данные в разных форматах
- Рекомендуется добавить unit-тесты для различных форматов данных
- Логировать предупреждения о нестандартных данных
